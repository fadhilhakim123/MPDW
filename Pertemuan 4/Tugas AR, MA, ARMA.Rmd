---
title: "Pertemuan 4 Praktikum MPDW"
author: "Muhammad Fadhil Hakim"
date: "2025-09-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1. Bangkitkan model MA(2) dengan θ1=0.4 dan θ2=0.6 sebanyak 300 data (Manual dan dengan arima.sim)

## Pembangkitan data MA(2) secara manual

```{r}
set.seed(125)  # biar hasil sama setiap run

n <- 300
theta1 <- 0.4
theta2 <- 0.6

# --- Cara manual ---
# epsilon ~ N(0,1)
eps <- rnorm(n + 2)  
y_manual <- numeric(n)

for (t in 3:(n+2)) {
  y_manual[t] <- eps[t] + theta1*eps[t-1] + theta2*eps[t-2]
}
y_manual <- y_manual[3:(n+2)]  # ambil data 300
y_manual <- ts(y_manual)
y_manual
```

## Pembangkitan data MA(2) dengan arima.sim

```{r}
# --- Cara dengan arima.sim ---
y_arima <- arima.sim(model = list(ma = c(theta1, theta2)), n = n)
y_arima <- ts(y_arima)
y_arima
```

## Karakteristik data MA(2)

### Plot Time Series, ACF, PACF, dan EACF

```{r}
library(TSA)   # untuk EACF

par(mfrow=c(2,2))
plot.ts(y_manual, main="Plot Time Series MA(2)")
acf(y_manual, main="ACF Data MA(2)")
pacf(y_manual, main="PACF Data MA(2)")
eacf(y_manual)
```

rangkuman : 1). Data MA(2) yang dibangkitkan stasioner dalam rataan berdasarkan plot time series, 2). ACF menunjukkan pola cut off pada lag 2, 3). PACF menunjukkan pola tails off dan membentuk pola sinus, 4). EACF menunjukkan pola segitiga pada baris ke-2.

## Scatter Plot antar Lag

### Scatterplot Yt dengan Yt−1,Yt−2,Yt−3

```{r}
par(mfrow=c(1,3))
plot(y_manual[-1], y_manual[-n], main="Yt vs Yt-1",
     xlab="Yt-1", ylab="Yt")
plot(y_manual[-c(1:2)], y_manual[-c((n-1):n)], main="Yt vs Yt-2",
     xlab="Yt-2", ylab="Yt")
plot(y_manual[-c(1:3)], y_manual[-c((n-2):n)], main="Yt vs Yt-3",
     xlab="Yt-3", ylab="Yt")
```

## Autokorelasi dari data bangkitan maupun teoritis

### Autokorelasi Data MA(2) Hasil Bangkitan

```{r}
acf_empiris_manual <- acf(y_manual, plot=FALSE)$acf[1:3]
acf_empiris_manual
acf_empiris_arima <- acf(y_arima, plot=FALSE)$acf[1:3]
acf_empiris_arima
```

### Autokorelasi Teoritis MA(2)

```{r}
# Varians proses
gamma0 <- 1 + theta1^2 + theta2^2
gamma1 <- theta1 + theta1*theta2
gamma2 <- theta2

rho1 <- gamma1/gamma0
rho2 <- gamma2/gamma0
rho3 <- 0

rho_teoritis <- c(rho1, rho2, rho3)
rho_teoritis
```

### Perbandingan Autokorelasi Empiris dan Teoritis

```{r}
data.frame(Lag=1:3, ACF_Empiris_manual=acf_empiris_manual,  ACF_Empiris_arima=acf_empiris_arima ,ACF_Teoritis=rho_teoritis)
```

Dari hasil di atas, dapat dilihat bahwa autokorelasi empiris mendekati autokorelasi teoritis untuk lag 1, 2, dan 3, yang menunjukkan bahwa model MA(2) yang dibangkitkan sesuai dengan karakteristik teoritisnya.

# 2. Bangkitkan model MA(2) dengan ϕ1=0.5 dan ϕ2=0.2 sebanyak 300 data (Manual dan dengan arima.sim)

## Pembangkitan data AR(2) secara manual

```{r}
set.seed(125)  # biar hasil sama setiap run
n <- 300
phi1 <- 0.5
phi2 <- 0.2
# --- Cara manual ---
# epsilon ~ N(0,1)
eps <- rnorm(n + 2)
y_manual_ar <- numeric(n + 2)
for (t in 3:(n+2)) {
  y_manual_ar[t] <- phi1*y_manual_ar[t-1] + phi2*y_manual_ar[t-2] + eps[t]
}
y_manual_ar <- y_manual_ar[3:(n+2)]  # ambil data 300
y_manual_ar <- ts(y_manual_ar)
y_manual_ar
```

## Pembangkitan data AR(2) dengan arima.sim

```{r}
# --- Cara dengan arima.sim ---
y_arima_ar <- arima.sim(model = list(ar = c(phi1, phi2)), n = n)
y_arima_ar <- ts(y_arima_ar)
y_arima_ar
```

## Karakteristik data AR(2)

### Plot Time Series, ACF, PACF, dan EACF

```{r}
library(TSA)   # untuk EACF
par(mfrow=c(2,2))
plot.ts(y_manual_ar, main="Plot Time Series AR(2)")
acf(y_manual_ar, main="ACF Data AR(2)")
pacf(y_manual_ar, main="PACF Data AR(2)")
eacf(y_manual_ar)
```

Rangkuman : 1). Data AR(2) yang dibangkitkan stasioner dalam rataan berdasarkan plot time series, 2). ACF menunjukkan pola tails off, 3). PACF menunjukkan pola cut off pada lag 2, 4). EACF menunjukkan pola segitiga pada baris ke-2.

## Scatter Plot antar Lag
### Scatterplot Yt dengan Yt−1,Yt−2,Yt−3
```{r}
par(mfrow=c(1,3))
plot(y_manual_ar[-1], y_manual_ar[-n], main="Yt vs Yt-1",
     xlab="Yt-1", ylab="Yt")
plot(y_manual_ar[-c(1:2)], y_manual_ar[-c((n-1):n)], main="Yt vs Yt-2",
     xlab="Yt-2", ylab="Yt")
plot(y_manual_ar[-c(1:3)], y_manual_ar[-c((n-2):n)], main="Yt vs Yt-3",
     xlab="Yt-3", ylab="Yt")
```

## Autokorelasi dari data bangkitan maupun teoritis

### Autokorelasi Data AR(2) Hasil Bangkitan

```{r}
acf_empiris_ar_manual <- acf(y_manual_ar, plot=FALSE)$acf[1:3]
acf_empiris_ar_manual
acf_empiris_ar_arima <- acf(y_arima_ar, plot=FALSE)$acf[1:3]
acf_empiris_ar_arima
```

### Autokorelasi Teoritis AR(2)

```{r}
rho <- numeric(3)
rho[1] <- phi1 / (1 - phi2)                 # rho1
rho[2] <- phi1 * rho[1] + phi2              # rho2
rho[3] <- phi1 * rho[2] + phi2 * rho[1]     # rho3

rho
```

### Perbandingan Autokorelasi Empiris dan Teoritis

```{r}
data.frame(Lag=1:3, ACF_Empiris_manual=acf_empiris_ar_manual, ACF_Empiris_arima=acf_empiris_ar_arima ,ACF_Teoritis=rho)
```

Dari hasil di atas, dapat dilihat bahwa autokorelasi empiris mendekati autokorelasi teoritis untuk lag 1, 2, dan 3, yang menunjukkan bahwa model AR(2) yang dibangkitkan sesuai dengan karakteristik teoritisnya.

# 3. Bangkitkan model ARMA(2,2) dengan θ1=0.4 & θ2=0.6 & ϕ1=0.5 & ϕ2=0.2 sebanyak 300 data (Manual dan dengan arima.sim)

## Pembangkitan data ARMA(2,2) secara manual

```{r}
set.seed(125)  # biar hasil sama setiap run
n <- 300
phi1 <- 0.5
phi2 <- 0.2
theta1 <- 0.4
theta2 <- 0.6
# --- Cara manual ---
# epsilon ~ N(0,1)
eps <- rnorm(n + 2)
y_manual_arma <- numeric(n + 2)
for (t in 3:(n+2)) {
  y_manual_arma[t] <- phi1*y_manual_arma[t-1] + phi2*y_manual_arma[t-2] + 
    eps[t] + theta1*eps[t-1] + theta2*eps[t-2]
}
y_manual_arma <- y_manual_arma[3:(n+2)]  # ambil data 300
y_manual_arma <- ts(y_manual_arma)
y_manual_arma
```

## Pembangkitan data ARMA(2,2) dengan arima.sim

```{r}
# --- Cara dengan arima.sim ---
y_arima_arma <- arima.sim(model = list(ar = c(phi1, phi2), ma = c(theta1, theta2)), n = n)
y_arima_arma <- ts(y_arima_arma)
y_arima_arma
```

## Karakteristik data ARMA(2,2)

### Plot Time Series, ACF, PACF, dan EACF

```{r}
library(TSA)   # untuk EACF
par(mfrow=c(2,2))
plot.ts(y_manual_arma, main="Plot Time Series ARMA(2,2)")
acf(y_manual_arma, main="ACF Data ARMA(2,2)")
pacf(y_manual_arma, main="PACF Data ARMA(2,2)")
eacf(y_manual_arma)
```

Rangkuman : 1). Data ARMA(2,2) yang dibangkitkan stasioner dalam rataan berdasarkan plot time series, 2). ACF menunjukkan pola tails off karena keberadaan komponen AR, 3). PACF menunjukkan tidak adanya pola cut off, menunjukkan keberadaan komponen MA, 4). EACF menunjukkan pola segitiga pada baris ke-2.

## Scatter Plot antar Lag
### Scatterplot Yt dengan Yt−1,Yt−2,Yt−3
```{r}
par(mfrow=c(1,3))
plot(y_manual_arma[-1], y_manual_arma[-n], main="Yt vs Yt-1",
     xlab="Yt-1", ylab="Yt")
plot(y_manual_arma[-c(1:2)], y_manual_arma[-c((n-1):n)], main="Yt vs Yt-2",
     xlab="Yt-2", ylab="Yt")
plot(y_manual_arma[-c(1:3)], y_manual_arma[-c((n-2):n)], main="Yt vs Yt-3",
     xlab="Yt-3", ylab="Yt")
```

## Autokorelasi dari data bangkitan

### Autokorelasi Data ARMA(2,2) Hasil Bangkitan

```{r}
acf_empiris_arma_manual <- acf(y_manual_arma, plot=FALSE)$acf[1:10]
acf_empiris_arma_manual
acf_empiris_arma_arima <- acf(y_arima_arma, plot=FALSE)$acf[1:10]
acf_empiris_arma_arima
```

### Autokorelasi Teoritis ARMA(2,2)

```{r}
# Parameter ARMA(2,2)
phi <- c(0.5, 0.2)        # phi1=0.5, phi2=0.2
theta <- c(0.4, 0.6)      # theta1=0.4, theta2=0.6

# Autokorelasi teoritis sampai lag 10
acf_theoretical <- ARMAacf(ar=phi, ma=theta, lag.max=10, pacf=FALSE)

acf_theoretical

```

### Perbandingan Autokorelasi Empiris dan Teoritis

```{r}
data.frame(Lag=1:10, ACF_Empiris_manual=acf_empiris_arma_manual, ACF_Empiris_arima=acf_empiris_arma_arima ,ACF_Teoritis=acf_theoretical[-1])

```

Dari hasil di atas, dapat dilihat bahwa autokorelasi empiris mendekati autokorelasi teoritis untuk lag 1 hingga lag 10, yang menunjukkan bahwa model ARMA(2,2) yang dibangkitkan sesuai dengan karakteristik teoritisnya.
